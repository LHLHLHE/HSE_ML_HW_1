# HSE_ML_HW_1

## Что было сделано
- **EDA и Обучение моделей:**
    - Заполнены `медианой` пропуски в числовых признаках
    - Предобработаны столбцы `mileage`, `engine`, `max_power` и `torque` (был оставлен и разделен на `torque_nm`, `rpm`)
    - Удалены дубликаты
    - Выведены основные статистики
    - Построены и графики зависимости признаков и хитмап с корреляцией
    - Обучены модели `LinearRegression`, `Lasso`, `ElasticNet`, `Ridge`. Посчитаны метрики
    - Для моделей `Lasso`, `ElasticNet`, `Ridge` были подобраны гиперпараметры с помощью `GridSearchCV`
    - В попытках улучшения качества моделей данные были стандартизированы. Перед обучением модели `Ridge` категориальные признаки (`seats` в том числе) были закодированы методом OneHot-кодирования. Также перед кодированием был предобработан столбец `name` для сокращения количества уникальных категорий в нем
    - Написана бизнес-метрика и по ней оценено качество моделей (лучшей оказалась `Ridge`)
    - Составлен пайплайн, содержащий заполнение пропусков, кодирование и стандартизацию данных
    - Пайплайн сохранен в pickle-файл

- **Сервис:**
    - Реализован эндпоинт для предсказания стоимости одного автомобиля, принимающий данные в виде JSON-объекта. В ответе отдает значение - предсказанную стоимость
    - Реализован эндпоинт для предсказания стоимости нескольких автомобилей, принимающий CSV-файл с данными. В ответе отдает исходный файл с добавленным столбцом `predicted_price`

## Результаты
- **Качество модели:**
  - Качество моделей `LinearRegression`, `Lasso`, `ElasticNet` практически одинаковое (оставляет желать лучшего) ($R^2$ около `0.6`; бизнес-метрика: `0.245`, `0.245` и `0.248` соответственно) и почти не меняется при попытках улучшить (стандартизация и подбор гиперпараметров)
  - Лучше всего показала себя модель `Ridge` после предобработки `name`, кодирования категориальных признаков и стандартизации числовых ($R^2$ `~0.78` на трейне и `~0.79` на тесте; бизнес-метрика: `0.302`)

- **Работа сервиса:**
  - Эндпоинты протестированы, работают корректно.
 ![alt text](<predict_item.png>)
 ![alt text](<predict_items.png>)

## Наибольший буст в качестве
Большой буст дало сохранение и предобработка `name` для модели `Ridge`, без этого $R^2$ было около `0.67`

## Что сделать не вышло
Не получилось поднять качество моделей `LinearRegression`, `Lasso`, `ElasticNet` (возможно был выбран неправильный набор значений для подбора гиперпараметров)
